<!--
 - Copyright (C) 2008 Google Inc.
 -
 - Licensed under the Apache License, Version 2.0 (the "License");
 - you may not use this file except in compliance with the License.
 - You may obtain a copy of the License at
 -
 -      http://www.apache.org/licenses/LICENSE-2.0
 -
 - Unless required by applicable law or agreed to in writing, software
 - distributed under the License is distributed on an "AS IS" BASIS,
 - WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 - See the License for the specific language governing permissions and
 - limitations under the License.
-->

<html>
  <head>
    <title>Search</title>

    <!-- Stub out firefox. -->
    <script type="text/javascript" src="firebugx.js"></script>

    <!-- Caja framework. -->
    <script type="text/javascript" src="caja.js"></script>

    <!-- Google Search API as documented at
      - http://code.google.com/apis/ajaxsearch/documentation/reference.html -->
    <!-- This allows us to serve from 127.0.0.1 -->
    <!--script type="text/javascript" src="http://www.google.com/jsapi?key=ABQIAAAARYHJOWhGvC-hnHaFO4oa7BRi_j0U6kJrkFvY4-OX2XYmEAa76BTIOZulNVZlEl6ODqNB1GWqhRyqZQ"></script-->
    <!-- Ihis allows us to serve from google-caja.googlecode.com -->
    <script type="text/javascript" src="http://www.google.com/jsapi?key=ABQIAAAARYHJOWhGvC-hnHaFO4oa7BRvHrijLxG0Kbzp8ris5IURMLbrEBS7CZj1UJz7CIXsA-YHseffaxlnlQ"></script>

    <!-- Container code. -->
    <script type="text/javascript">google.load('search', '1');</script>
    <script type="text/javascript" src="searchengine.js"></script>
    <script type="text/javascript" src="chtml.js"></script>
    <script type="text/javascript" src="unicode.js"></script>
    <script type="text/javascript" src="html4-defs.js"></script>
    <script type="text/javascript" src="html-sanitizer.js"></script>
    <script type="text/javascript" src="html-emitter.js"></script>
    <script type="text/javascript" src="domita.js"></script>
  </head>
  <body bgcolor="white">
    <!-- Define some DOM nodes which will be accessible to the gadgets. -->
    <!-- One for the searchbox gadget -->
    <div id="searchbox-base" class="searchbox"></div>

    <hr>

    <!-- One for the kittens gadget. -->
    <div id="kittens-base" class="kittens" style="float: right"></div>
    <!-- And another for the searchbox gadget. -->
    <div class=searchbox><ul id="searchbox-results"></ul></div>

    <!--
      - Initialize separate global namespaces for each plugin as specified at
      - http://code.google.com/p/google-caja/wiki/CajaHostingModules
     -->
    <script type="text/javascript">
      var searchBoxOuters = ___.copy(___.sharedOuters);
      attachDocumentStubs('searchbox-', searchBoxOuters);
      searchBoxOuters.htmlEmitter___ = new HtmlEmitter(
          document.getElementById('searchbox-base'));
      ___.getNewModuleHandler().setOuters(searchBoxOuters);
    </script>
    <script type="text/javascript" src=searchbox-cajoled.js></script>
    <script type="text/javascript">closeGadgetRoot();</script>
    <link rel="stylesheet" type="text/css" href="searchbox-cajoled.css" />
    <script type="text/javascript">
      var kittensOuters = ___.copy(___.sharedOuters);
      attachDocumentStubs('kittens-', kittensOuters);
      kittensOuters.htmlEmitter___ = new HtmlEmitter(
          document.getElementById('kitten-base'));
      ___.getNewModuleHandler().setOuters(kittensOuters);
    </script>
    <script type="text/javascript" src="kittens-cajoled.js"></script>
    <script type="text/javascript">closeGadgetRoot();</script>
    <link rel="stylesheet" type="text/css" href="kittens-cajoled.css" />

    <!-- Inject some capabilities into the 2 plugins. -->
    <script type="text/javascript">
      (function () {
        google.load('search', '1');

        var searchEngine = new SearchEngine();

        // Provide both modules an interface to Google search.
        searchBoxOuters.searchEngine = kittensOuters.searchEngine
            = searchEngine;

        // Allow searchBoxOuters to talk to kittens.
        searchBoxOuters.resultConsumer = kittensOuters.showKitten;
      })();
    </script>
  </body>
</html>
